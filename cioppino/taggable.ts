import * as pulumi from "@pulumi/pulumi";

/**
 * registerAutoTags registers a global stack transformation that merges a set
 * of tags with whatever was also explicitly added to the resource definition.
 */
export function tagAllResources(autoTags: Record<string, string>): void {
    pulumi.runtime.registerStackTransformation((args) => {
        if (isTaggable(args.type)) {
            // Merge current tags with provided tags
            args.props["tags"] = {
                Name: args.name, // set a tag, but allow overrides on the resource itself
                ...args.props["tags"],
                ...autoTags,
            };
            return { props: args.props, opts: args.opts };
        }
        return undefined;
    });
}

/**
 * isTaggable returns true if the given resource type is an AWS resource that supports tags.
 */
export function isTaggable(t: string): boolean {
    return (taggableResourceTypes.indexOf(t) !== -1);
}

// The list below is based on this: https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/tag-support
// Currently, this is a manual effort.
// taggableResourceTypes is a list of known Azure Next Gen type tokens that are taggable.
const taggableResourceTypes = [
"azure-nextgen:agfoodplatform/latest:Farmbeat",
"azure-nextgen:alertsmanagement/latest:Actionrule",
"azure-nextgen:alertsmanagement/latest:SmartDetectorAlertRule",
"azure-nextgen:analysisservices/latest:Server",
"azure-nextgen:apimanagement/latest:service",
"azure-nextgen:appconfiguration/latest:ConfigurationStore",
"azure-nextgen:appplatform/latest:Spring",
"azure-nextgen:attestation/latest:AttestationProvider",
"azure-nextgen:authorization/latest:Resourcemanagementprivatelink",
"azure-nextgen:automanage/latest:Account",
"azure-nextgen:automanage/latest:ConfigurationProfilePreference",
"azure-nextgen:automation/latest:AutomationAccount",
"azure-nextgen:automation/latest:Configuration",
"azure-nextgen:automation/latest:Runbook",
"azure-nextgen:avs/latest:PrivateCloud",
"azure-nextgen:azureactivedirectory/latest:B2cdirectorie",
"azure-nextgen:azureactivedirectory/latest:Guestusage",
"azure-nextgen:azuredata/latest:DataController",
"azure-nextgen:azuredata/latest:PostgresInstance",
"azure-nextgen:azuredata/latest:SqlManagedInstance",
"azure-nextgen:azuredata/latest:SqlServerInstance",
"azure-nextgen:azuredata/latest:SqlServerRegistration",
"azure-nextgen:azurestack/latest:Edgesubscription",
"azure-nextgen:azurestack/latest:Linkedsubscription",
"azure-nextgen:azurestack/latest:Registration",
"azure-nextgen:azurestackhci/latest:Cluster",
"azure-nextgen:batch/latest:BatchAccount",
"azure-nextgen:bingmaps/latest:Mapapi",
"azure-nextgen:blockchain/latest:BlockchainMember",
"azure-nextgen:blockchain/latest:Cordamember",
"azure-nextgen:blockchain/latest:Watcher",
"azure-nextgen:blockchaintokens/latest:Tokenservice",
"azure-nextgen:botservice/latest:Botservice",
"azure-nextgen:cache/latest:Redis",
"azure-nextgen:cache/latest:Redisenterprise",
"azure-nextgen:cdn/latest:Cdnwebapplicationfirewallpolicie",
"azure-nextgen:cdn/latest:Profile",
"azure-nextgen:cdn/latest:Endpoint",
"azure-nextgen:certificateregistration/latest:Certificateorder",
"azure-nextgen:codespaces/latest:Plan",
"azure-nextgen:cognitiveservices/latest:Account",
"azure-nextgen:compute/latest:AvailabilitySet",
"azure-nextgen:compute/latest:CloudService",
"azure-nextgen:compute/latest:DiskAccesse",
"azure-nextgen:compute/latest:DiskEncryptionSet",
"azure-nextgen:compute/latest:Disk",
"azure-nextgen:compute/latest:Gallery",
"azure-nextgen:compute/latest:HostGroup",
"azure-nextgen:compute/latest:Host",
"azure-nextgen:compute/latest:Image",
"azure-nextgen:compute/latest:ProximityPlacementGroup",
"azure-nextgen:compute/latest:Restorepointcollection",
"azure-nextgen:compute/latest:Sharedvmextension",
"azure-nextgen:compute/latest:Sharedvmimage",
"azure-nextgen:compute/latest:Snapshot",
"azure-nextgen:compute/latest:SshPublicKey",
"azure-nextgen:compute/latest:VirtualMachine",
"azure-nextgen:compute/latest:VirtualMachineExtension",
"azure-nextgen:compute/latest:RunCommand",
"azure-nextgen:compute/latest:VirtualMachineScaleSet",
"azure-nextgen:connectedcache/latest:Cachenode",
"azure-nextgen:containerinstance/latest:ContainerGroup",
"azure-nextgen:containerregistry/latest:Registriy",
"azure-nextgen:containerregistry/latest:AgentPool",
"azure-nextgen:containerregistry/latest:BuildTask",
"azure-nextgen:containerregistry/latest:Replication",
"azure-nextgen:containerregistry/latest:Task",
"azure-nextgen:containerregistry/latest:Webhook",
"azure-nextgen:containerservice/latest:ContainerService",
"azure-nextgen:containerservice/latest:ManagedCluster",
"azure-nextgen:containerservice/latest:OpenShiftManagedCluster",
"azure-nextgen:costmanagement/latest:Connector",
"azure-nextgen:customproviders/latest:Resourceprovider",
"azure-nextgen:d365customerinsights/latest:Instance",
"azure-nextgen:databox/latest:Job",
"azure-nextgen:databoxedge/latest:Databoxedgedevice",
"azure-nextgen:databricks/latest:Workspace",
"azure-nextgen:datacatalog/latest:Catalog",
"azure-nextgen:datafactory/latest:DataFactory",
"azure-nextgen:datafactory/latest:Factory",
"azure-nextgen:datalakeanalytics/latest:Account",
"azure-nextgen:datalakestore/latest:Account",
"azure-nextgen:dataprotection/latest:Backupvault",
"azure-nextgen:dataprotection/latest:Resourceoperationgatekeeper",
"azure-nextgen:datashare/latest:Account",
"azure-nextgen:dbformariadb/latest:Server",
"azure-nextgen:dbformysql/latest:Flexibleserver",
"azure-nextgen:dbformysql/latest:Server",
"azure-nextgen:dbforpostgresql/latest:Flexibleserver",
"azure-nextgen:dbforpostgresql/latest:Servergroup",
"azure-nextgen:dbforpostgresql/latest:Server",
"azure-nextgen:dbforpostgresql/latest:Serversv2",
"azure-nextgen:deploymentmanager/latest:ArtifactSource",
"azure-nextgen:deploymentmanager/latest:Rollout",
"azure-nextgen:deploymentmanager/latest:ServiceTopology",
"azure-nextgen:deploymentmanager/latest:Service",
"azure-nextgen:deploymentmanager/latest:ServiceUnit",
"azure-nextgen:deploymentmanager/latest:Step",
"azure-nextgen:desktopvirtualization/latest:ApplicationGroup",
"azure-nextgen:desktopvirtualization/latest:HostPool",
"azure-nextgen:desktopvirtualization/latest:Workspace",
"azure-nextgen:devices/latest:Elasticpool",
"azure-nextgen:devices/latest:Iothubtenant",
"azure-nextgen:devices/latest:Iothub",
"azure-nextgen:devices/latest:Provisioningservice",
"azure-nextgen:deviceupdate/latest:Account",
"azure-nextgen:deviceupdate/latest:Accounts/instance",
"azure-nextgen:devops/latest:Pipeline",
"azure-nextgen:devspaces/latest:Controller",
"azure-nextgen:devtestlab/latest:Labcenter",
"azure-nextgen:devtestlab/latest:Lab",
"azure-nextgen:devtestlab/latest:Environment",
"azure-nextgen:devtestlab/latest:ServiceRunner",
"azure-nextgen:devtestlab/latest:VirtualMachine",
"azure-nextgen:devtestlab/latest:Schedule",
"azure-nextgen:digitaltwins/latest:DigitalTwinsInstance",
"azure-nextgen:documentdb/latest:DatabaseAccount",
"azure-nextgen:domainregistration/latest:Domain",
"azure-nextgen:enterpriseknowledgegraph/latest:Service",
"azure-nextgen:eventgrid/latest:Domain",
"azure-nextgen:eventgrid/latest:PartnerNamespace",
"azure-nextgen:eventgrid/latest:PartnerRegistration",
"azure-nextgen:eventgrid/latest:PartnerTopic",
"azure-nextgen:eventgrid/latest:SystemTopic",
"azure-nextgen:eventgrid/latest:Topic",
"azure-nextgen:eventhub/latest:Cluster",
"azure-nextgen:eventhub/latest:Namespace",
"azure-nextgen:experimentation/latest:Experimentworkspace",
"azure-nextgen:falcon/latest:Namespace",
"azure-nextgen:genomics/latest:Account",
"azure-nextgen:guestconfiguration/latest:Automanagedaccount",
"azure-nextgen:guestconfiguration/latest:Automanagedvmconfigurationprofile",
"azure-nextgen:hanaonazure/latest:HanaInstance",
"azure-nextgen:hanaonazure/latest:SapMonitor",
"azure-nextgen:hardwaresecuritymodules/latest:DedicatedHsm",
"azure-nextgen:hdinsight/latest:Cluster",
"azure-nextgen:healthcareapis/latest:Service",
"azure-nextgen:hybridcompute/latest:Machine",
"azure-nextgen:hybridcompute/latest:MachinesExtension",
"azure-nextgen:hybriddata/latest:DataManager",
"azure-nextgen:hybridnetwork/latest:Device",
"azure-nextgen:hybridnetwork/latest:VirtualNetworkFunction",
"azure-nextgen:hydra/latest:Component",
"azure-nextgen:hydra/latest:Networkscope",
"azure-nextgen:importexport/latest:Job",
"azure-nextgen:insights/latest:ActionGroup",
"azure-nextgen:insights/latest:ActivityLogAlert",
"azure-nextgen:insights/latest:AlertRule",
"azure-nextgen:insights/latest:AutoscaleSetting",
"azure-nextgen:insights/latest:Component",
"azure-nextgen:insights/latest:GuestDiagnosticSetting",
"azure-nextgen:insights/latest:GuestDiagnosticSettingsAssociation",
"azure-nextgen:insights/latest:LogProfile",
"azure-nextgen:insights/latest:MetricAlert",
"azure-nextgen:insights/latest:PrivateLinkScope",
"azure-nextgen:insights/latest:QueryPack",
"azure-nextgen:insights/latest:ScheduledQueryRule",
"azure-nextgen:insights/latest:WebTest",
"azure-nextgen:insights/latest:Workbook",
"azure-nextgen:insights/latest:WorkbookTemplate",
"azure-nextgen:iotcentral/latest:App",
"azure-nextgen:iotspaces/latest:Grap",
"azure-nextgen:keyvault/latest:Hsmpool",
"azure-nextgen:keyvault/latest:ManagedHsm",
"azure-nextgen:keyvault/latest:Vault",
"azure-nextgen:kubernetes/latest:ConnectedCluster",
"azure-nextgen:kusto/latest:Cluster",
"azure-nextgen:labservices/latest:LabAccount",
"azure-nextgen:logic/latest:Hostingenvironment",
"azure-nextgen:logic/latest:IntegrationAccount",
"azure-nextgen:logic/latest:IntegrationServiceEnvironment",
"azure-nextgen:logic/latest:IsolatedEnvironment",
"azure-nextgen:logic/latest:Workflow",
"azure-nextgen:machinelearning/latest:CommitmentPlan",
"azure-nextgen:machinelearning/latest:WebService",
"azure-nextgen:machinelearning/latest:Workspace",
"azure-nextgen:machinelearningservices/latest:Workspace",
"azure-nextgen:machinelearningservices/latest:InferenceEndpoint",
"azure-nextgen:machinelearningservices/latest:Deployment",
"azure-nextgen:maintenance/latest:MaintenanceConfiguration",
"azure-nextgen:managedidentity/latest:UserAssignedIdentity",
"azure-nextgen:managednetwork/latest:ManagedNetwork",
"azure-nextgen:managednetwork/latest:ManagedNetworkGroup",
"azure-nextgen:managednetwork/latest:ManagedNetworkPeeringPolicy",
"azure-nextgen:managednetwork/latest:Notification",
"azure-nextgen:maps/latest:Account",
"azure-nextgen:maps/latest:PrivateAtlase",
"azure-nextgen:marketplaceapps/latest:Classicdevservice",
"azure-nextgen:media/latest:MediaService",
"azure-nextgen:media/latest:LiveEvent",
"azure-nextgen:media/latest:StreamingEndpoint",
"azure-nextgen:microservices4spring/latest:Appcluster",
"azure-nextgen:migrate/latest:Assessmentproject",
"azure-nextgen:migrate/latest:MigrateProject",
"azure-nextgen:migrate/latest:MoveCollection",
"azure-nextgen:migrate/latest:Project",
"azure-nextgen:mixedreality/latest:Holographicsbroadcastaccount",
"azure-nextgen:mixedreality/latest:Objectunderstandingaccount",
"azure-nextgen:mixedreality/latest:RemoteRenderingAccount",
"azure-nextgen:mixedreality/latest:SpatialAnchorsAccount",
"azure-nextgen:netapp/latest:Netappaccount",
"azure-nextgen:netapp/latest:Pool",
"azure-nextgen:netapp/latest:Volume",
"azure-nextgen:network/latest:ApplicationGateway",
"azure-nextgen:network/latest:ApplicationGatewayWebapplicationfirewallpolicie",
"azure-nextgen:network/latest:ApplicationSecurityGroup",
"azure-nextgen:network/latest:AzureFirewall",
"azure-nextgen:network/latest:BastionHost",
"azure-nextgen:network/latest:Connection",
"azure-nextgen:network/latest:DdosCustomPolicy",
"azure-nextgen:network/latest:DdosProtectionPlan",
"azure-nextgen:network/latest:Dnszone",
"azure-nextgen:network/latest:ExpressRouteCircuit",
"azure-nextgen:network/latest:ExpressRouteCrossConnection",
"azure-nextgen:network/latest:ExpressRoutegateway",
"azure-nextgen:network/latest:ExpressRouteport",
"azure-nextgen:network/latest:FirewallPolicy",
"azure-nextgen:network/latest:Frontdoor",
"azure-nextgen:network/latest:Frontdoorwebapplicationfirewallmanagedruleset",
"azure-nextgen:network/latest:Frontdoorwebapplicationfirewallpolicie",
"azure-nextgen:network/latest:IpGroup",
"azure-nextgen:network/latest:LoadBalancer",
"azure-nextgen:network/latest:LocalNetworkGateway",
"azure-nextgen:network/latest:NatGateway",
"azure-nextgen:network/latest:NetworkIntentPolicy",
"azure-nextgen:network/latest:NetworkInterface",
"azure-nextgen:network/latest:NetworkProfile",
"azure-nextgen:network/latest:NetworkSecurityGroup",
"azure-nextgen:network/latest:NetworkWatcher",
"azure-nextgen:network/latest:ConnectionMonitor",
"azure-nextgen:network/latest:Lense",
"azure-nextgen:network/latest:Pingmeshe",
"azure-nextgen:network/latest:P2sVpnGateway",
"azure-nextgen:network/latest:PrivateDnsZone",
"azure-nextgen:network/latest:VirtualNetworkLink",
"azure-nextgen:network/latest:PrivatEendpoint",
"azure-nextgen:network/latest:PrivateLinkService",
"azure-nextgen:network/latest:PublicIPAddresse",
"azure-nextgen:network/latest:PublicIPPrefixe",
"azure-nextgen:network/latest:RouteFilter",
"azure-nextgen:network/latest:RouteTable",
"azure-nextgen:network/latest:ServiceEndPointPolicy",
"azure-nextgen:network/latest:TrafficManagerProfile",
"azure-nextgen:network/latest:VirtualHub",
"azure-nextgen:network/latest:VirtualNetworkGateway",
"azure-nextgen:network/latest:VirtualNetwork",
"azure-nextgen:network/latest:VirtualNetworkTap",
"azure-nextgen:network/latest:VirtualWan",
"azure-nextgen:network/latest:VpnGateway",
"azure-nextgen:network/latest:VpnSite",
"azure-nextgen:network/latest:WebApplicationFirewallPolicy",
"azure-nextgen:notificationhubs/latest:Namespace",
"azure-nextgen:notificationhubs/latest:NotificationHub",
"azure-nextgen:objectstore/latest:Osnamespace",
"azure-nextgen:offazure/latest:HyperVSite",
"azure-nextgen:offazure/latest:ImportSite",
"azure-nextgen:offazure/latest:MasterSite",
"azure-nextgen:offazure/latest:ServerSite",
"azure-nextgen:offazure/latest:VmwareSite",
"azure-nextgen:operationalinsights/latest:Cluster",
"azure-nextgen:operationalinsights/latest:Workspace",
"azure-nextgen:operationsmanagement/latest:ManagementConfiguration",
"azure-nextgen:operationsmanagement/latest:Solution",
"azure-nextgen:operationsmanagement/latest:View",
"azure-nextgen:peering/latest:Peering",
"azure-nextgen:peering/latest:PeeringService",
"azure-nextgen:portal/latest:Dashboard",
"azure-nextgen:powerbi/latest:Privatelinkservicesforpowerb",
"azure-nextgen:powerbi/latest:Tenant",
"azure-nextgen:powerbi/latest:WorkspaceCollection",
"azure-nextgen:powerbidedicated/latest:Capacity",
"azure-nextgen:projectbabylon/latest:Account",
"azure-nextgen:providerhub/latest:Rollout",
"azure-nextgen:quantum/latest:Workspace",
"azure-nextgen:recoveryservices/latest:Vault",
"azure-nextgen:redhatopenshift/latest:OpenShiftCluster",
"azure-nextgen:relay/latest:Namespace",
"azure-nextgen:resourcegraph/latest:Query",
"azure-nextgen:resources/latest:Deployment",
"azure-nextgen:resources/latest:DeploymentScript",
"azure-nextgen:resources/latest:ResourceGroup",
"azure-nextgen:resources/latest:Subscription",
"azure-nextgen:resources/latest:TemplateSpec",
"azure-nextgen:resources/latest:TemplateSpecsVersion",
"azure-nextgen:saas/latest:Application",
"azure-nextgen:scvmm/latest:Cloud",
"azure-nextgen:scvmm/latest:Virtualmachine",
"azure-nextgen:scvmm/latest:Virtualmachinetemplate",
"azure-nextgen:scvmm/latest:Virtualnetwork",
"azure-nextgen:scvmm/latest:Vmmserver",
"azure-nextgen:search/latest:SearchService",
"azure-nextgen:security/latest:Automation",
"azure-nextgen:security/latest:IotSecuritySolution",
"azure-nextgen:servicebus/latest:Namespace",
"azure-nextgen:servicefabric/latest:Application",
"azure-nextgen:servicefabric/latest:Cluster",
"azure-nextgen:servicefabric/latest:ContainerGroup",
"azure-nextgen:servicefabric/latest:ContainerGroupSet",
"azure-nextgen:servicefabric/latest:EdgeCluster",
"azure-nextgen:servicefabric/latest:ManagedCluster",
"azure-nextgen:servicefabric/latest:Network",
"azure-nextgen:servicefabric/latest:SecretStore",
"azure-nextgen:servicefabric/latest:Volume",
"azure-nextgen:servicefabricmesh/latest:Application",
"azure-nextgen:servicefabricmesh/latest:ContainerGroup",
"azure-nextgen:servicefabricmesh/latest:Gateway",
"azure-nextgen:servicefabricmesh/latest:Network",
"azure-nextgen:servicefabricmesh/latest:Secret",
"azure-nextgen:servicefabricmesh/latest:Volume",
"azure-nextgen:services/latest:Rollout",
"azure-nextgen:signalrservice/latest:Signal",
"azure-nextgen:solutions/latest:ApplicationDefinition",
"azure-nextgen:solutions/latest:Application",
"azure-nextgen:solutions/latest:JitRequest",
"azure-nextgen:sql/latest:ManagedInstance",
"azure-nextgen:sql/latest:ManagedInstances/database",
"azure-nextgen:sql/latest:Server",
"azure-nextgen:sql/latest:Database",
"azure-nextgen:sqlvirtualmachine/latest:SqlVirtualMachineGroup",
"azure-nextgen:sqlvirtualmachine/latest:SqlVirtualMachine",
"azure-nextgen:storage/latest:StorageAccount",
"azure-nextgen:storagecache/latest:Cache",
"azure-nextgen:storagesync/latest:StorageSyncService",
"azure-nextgen:storagesyncdev/latest:StorageSyncService",
"azure-nextgen:storagesyncint/latest:StorageSyncService",
"azure-nextgen:storsimple/latest:Manager",
"azure-nextgen:streamanalytics/latest:Cluster",
"azure-nextgen:streamanalytics/latest:StreamingJob",
"azure-nextgen:synapse/latest:PrivateLinkHub",
"azure-nextgen:synapse/latest:Workspace",
"azure-nextgen:synapse/latest:BigDataPool",
"azure-nextgen:synapse/latest:SqlDatabase",
"azure-nextgen:synapse/latest:SqlPool",
"azure-nextgen:timeseriesinsights/latest:Environment",
"azure-nextgen:timeseriesinsights/latest:EventSource",
"azure-nextgen:timeseriesinsights/latest:ReferenceDataSet",
"azure-nextgen:token/latest:Store",
"azure-nextgen:virtualmachineimages/latest:Imagetemplate",
"azure-nextgen:vmware/latest:Arczone",
"azure-nextgen:vmware/latest:Resourcepool",
"azure-nextgen:vmware/latest:Vcenter",
"azure-nextgen:vmware/latest:Virtualmachine",
"azure-nextgen:vmware/latest:Virtualmachinetemplate",
"azure-nextgen:vmware/latest:Virtualnetwork",
"azure-nextgen:vmwarecloudsimple/latest:DedicatedCloudNode",
"azure-nextgen:vmwarecloudsimple/latest:DedicatedCloudService",
"azure-nextgen:vmwarecloudsimple/latest:VirtualMachine",
"azure-nextgen:vnfmanager/latest:Device",
"azure-nextgen:vnfmanager/latest:Vnf",
"azure-nextgen:vsonline/latest:Account",
"azure-nextgen:vsonline/latest:Plan",
"azure-nextgen:web/latest:Certificate",
"azure-nextgen:web/latest:ConnectionGateway",
"azure-nextgen:web/latest:Connection",
"azure-nextgen:web/latest:CustomApi",
"azure-nextgen:web/latest:HostingEnvironment",
"azure-nextgen:web/latest:KubeEnvironment",
"azure-nextgen:web/latest:ServerFarm",
"azure-nextgen:web/latest:Site",
"azure-nextgen:web/latest:Premieraddon",
"azure-nextgen:web/latest:Slot",
"azure-nextgen:web/latest:StaticSite",
"azure-nextgen:windowsesu/latest:MultipleActivationKey",
"azure-nextgen:windowsiot/latest:Deviceservice",
"azure-nextgen:workloadbuilder/latest:Workload",
];
